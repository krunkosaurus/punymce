(function(a){a.plugins.Textile=function(b){b.onGetContent.add(function(c,d){if(d.format=="textile"||d.save){a.each([[/<(br\s*\/)>/gi,"\n"],[/<(\/?)(strong|b)[^>]*>/gi,"*"],[/<(\/?)(em|i)[^>]*>/gi,"_"],[/<(\/?)u[^>]*>/gi,"+"],[/<p>/gi,""],[/<\/p>/gi,"\n"],[/<span class="(.*)">/gi,"%($1)"],[/<\/span>/gi,"%"]],function(e){d.content=d.content.replace(e[0],e[1])})}});b.onSetContent.add(function(c,d){if(d.format=="textile"||d.load){a.each([[/\n/gi,"<br />"],[/\*(.*)\*/gi,"<strong>$1</strong>"],[/_(.*)_/gi,"<em>$1</em>"],[/\+(.*)\+/gi,"<u>$1</u>"],[/%\((.*)\)(.*)%/gi,'<span class="$1">$2</span>']],function(e){d.content=d.content.replace(e[0],e[1])})}})}})(punymce);